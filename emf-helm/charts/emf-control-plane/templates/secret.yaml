apiVersion: v1
kind: Secret
metadata:
  name: {{ include "emf-control-plane.secretName" . }}
  labels:
    {{- include "emf-control-plane.labels" . | nindent 4 }}
type: Opaque
data:
  # Database password - MUST be overridden in production
  # Default value is base64 encoded "changeme"
  # Override with: --set-string secrets.dbPassword=<base64-encoded-password>
  # Or use external secret management (e.g., External Secrets Operator, Vault)
  DB_PASSWORD: {{ default "Y2hhbmdlbWU=" .Values.secrets.dbPassword | quote }}
  
  # Redis password (optional, empty by default)
  # Override with: --set-string secrets.redisPassword=<base64-encoded-password>
  REDIS_PASSWORD: {{ default "" .Values.secrets.redisPassword | quote }}
---
{{- if .Values.secrets.existingSecret }}
# Note: When using an existing secret, ensure it contains the following keys:
# - DB_PASSWORD: PostgreSQL database password
# - REDIS_PASSWORD: Redis password (optional)
{{- end }}
