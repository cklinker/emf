{
  "project": {
    "name": "EMF Enterprise Platform",
    "identifier": "EMF",
    "description": "Enterprise Metadata Framework - Multi-tenant configurable platform with 6-phase development roadmap."
  },
  "labels": {
    "work_streams": [
      "Tenant Core",
      "Users & Auth",
      "Permissions",
      "Sharing",
      "OIDC",
      "Cross-cutting"
    ],
    "phases": [
      "Phase 1",
      "Phase 2",
      "Phase 3",
      "Phase 4",
      "Phase 5",
      "Phase 6"
    ]
  },
  "tasks": [
    {
      "id": "A1",
      "name": "Tenant Database Migration",
      "description": "Create Flyway migration V8__add_tenant_table.sql with tenant table (id, slug, name, edition, status, settings JSONB, limits JSONB). Includes check constraints for edition, status, and slug format. Index on status.\n\nAcceptance criteria:\n- Migration runs cleanly on fresh and existing databases\n- Constraint checks pass for valid/invalid slugs, editions, statuses\n- No impact on existing tables",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": []
    },
    {
      "id": "A2",
      "name": "Tenant Entity Class",
      "description": "JPA entity extending BaseEntity for the tenant table. Fields: slug (unique, 63 chars), name, edition (default PROFESSIONAL), status (default PROVISIONING), settings (JSONB), limits (JSONB). Follow existing BaseEntity pattern with UUID id, @Column annotations, AuditingEntityListener.\n\nIntegration: Referenced as FK by most other entities.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A1"]
    },
    {
      "id": "A3",
      "name": "Tenant Service and Repository",
      "description": "TenantRepository extending JpaRepository with findBySlug, findByIdAndStatus, existsBySlug, findByStatus, findAll. TenantService with createTenant (validates slug, provisions schema, sets ACTIVE), getTenant, getTenantBySlug, listTenants, updateTenant, suspendTenant, activateTenant, getGovernorLimits.\n\nDTOs: CreateTenantRequest, UpdateTenantRequest, GovernorLimits record.\nError handling: DuplicateResourceException, ResourceNotFoundException, ValidationException.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A2"]
    },
    {
      "id": "A4",
      "name": "Tenant Controller",
      "description": "REST controller at /platform/tenants with PLATFORM_ADMIN security. Endpoints: GET (list paginated), POST (create), GET /{id}, PUT /{id}, POST /{id}/suspend, POST /{id}/activate, GET /{id}/limits.\n\nSecurity: @PreAuthorize(\"hasRole('PLATFORM_ADMIN')\") on all endpoints.",
      "priority": "high",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A3"]
    },
    {
      "id": "A5",
      "name": "TenantContextHolder",
      "description": "Thread-local storage for current tenant context. TenantContext record with tenantId and tenantSlug. Static methods: set(), get(), getTenantId(), getTenantSlug(), clear(), isSet().\n\nUsage: Set in request filters (A11), read by repositories (A9) and services (A10), cleared in filter's finally block.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A3"]
    },
    {
      "id": "A6",
      "name": "Add tenant_id to Existing Tables",
      "description": "Flyway migration V9__add_tenant_id_to_existing_tables.sql. Create default 'platform' tenant. Add tenant_id column (nullable -> backfill -> NOT NULL) to: service, collection, role, policy, oidc_provider, ui_page, ui_menu, package, migration_run. Add FK constraints and indexes. Recreate unique constraints to include tenant_id.\n\nStrategy: nullable add -> backfill with default tenant -> set NOT NULL -> add FK + index.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A1"]
    },
    {
      "id": "A7",
      "name": "Update Existing Entities with tenantId",
      "description": "Add @Column(name = \"tenant_id\", nullable = false, length = 36) private String tenantId to: Service, Collection, Role, Policy, OidcProvider, UiPage, UiMenu, ConfigPackage, MigrationRun entities. Add constructors, getters, setters.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A6"]
    },
    {
      "id": "A8",
      "name": "TenantSchemaManager",
      "description": "Component that provisions and manages per-tenant database state. Methods: provisionSchema(tenantSlug) - creates tenant record and seeds defaults; dropSchema(tenantSlug) - for decommissioning; schemaExists(tenantSlug); runMigrations(tenantSlug).\n\nPhase 1 approach: keep all data in public schema with tenant_id FK filtering. Schema-per-tenant can be added later.",
      "priority": "high",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A3"]
    },
    {
      "id": "A9",
      "name": "Update All Repositories with Tenant Filtering",
      "description": "Every query must be scoped to current tenant. Update: CollectionRepository (findByTenantIdAndActiveTrue), ServiceRepository, RoleRepository, PolicyRepository, OidcProviderRepository, UiPageRepository, UiMenuRepository, FieldRepository (via collection join), RoutePolicyRepository, FieldPolicyRepository.\n\nPattern: add tenantId parameter to all finder methods.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A7"]
    },
    {
      "id": "A10",
      "name": "Update All Services with Tenant Context",
      "description": "Every service method must scope operations to current tenant. Update: CollectionService, FieldService, ServiceService, AuthorizationService, OidcProviderService, UiConfigService, PackageService, MigrationService, DiscoveryService, GatewayBootstrapService.\n\nPattern: get tenantId from TenantContextHolder, pass to repository queries, set on new entities before save.",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A5", "A9"]
    },
    {
      "id": "A11",
      "name": "Tenant Resolution Filter",
      "description": "OncePerRequestFilter for control plane, GlobalFilter for gateway. Resolution chain: 1) X-Tenant-ID header, 2) JWT org_id claim, 3) subdomain extraction. Sets TenantContextHolder, clears in finally block. Returns 400 if no tenant resolved (except exempt paths: /actuator/**, /platform/**, /ui/config/bootstrap).\n\nCache tenant lookups in Redis (key: tenant:slug:{slug}, TTL: 5 min).",
      "priority": "urgent",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A5"]
    },
    {
      "id": "A12",
      "name": "Update Gateway Header Propagation",
      "description": "Modify HeaderTransformationFilter to propagate X-Tenant-ID and X-Tenant-Slug headers from gateway to downstream services. Read tenant from exchange attributes set by TenantResolutionFilter.",
      "priority": "high",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A11"]
    },
    {
      "id": "A13",
      "name": "Tenant Administration UI",
      "description": "Frontend page TenantManagement.tsx for platform admins. SDK additions: AdminClient.tenants with list, get, create, update, suspend, activate, getLimits. UI features: tenant table with status badge, create dialog with slug validation, edit dialog, suspend/activate actions, status filter, search.\n\nNavigation: Add Platform Admin section to UiMenu.",
      "priority": "medium",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A4"]
    },
    {
      "id": "A14",
      "name": "Tenant Dashboard UI",
      "description": "Per-tenant usage and health metrics page TenantDashboard.tsx. Displays: API calls today/limit, storage used/limit, active users/limit, collections count/limit, recent login activity, system health indicators.\n\nBackend endpoint: GET /control/dashboard (tenant-scoped).",
      "priority": "low",
      "labels": ["Phase 1", "Tenant Core"],
      "blocked_by": ["A13"]
    },
    {
      "id": "B1",
      "name": "User Database Migration",
      "description": "Flyway migration V10__add_user_tables.sql. Creates platform_user table (id, tenant_id FK, email, username, first_name, last_name, status, locale, timezone, profile_id, manager_id self-ref FK, last_login_at, login_count, mfa_enabled, settings JSONB). Creates login_history table. Indexes on tenant, email, manager, status.\n\nNote: profile_id FK added in C1 after profile table exists.",
      "priority": "urgent",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["A6"]
    },
    {
      "id": "B2",
      "name": "User Entity Class",
      "description": "JPA entity extending BaseEntity for platform_user table. Fields: tenantId, email, username, firstName, lastName, status, locale, timezone, profileId, manager (ManyToOne self-ref), lastLoginAt, loginCount, mfaEnabled, settings JSONB. Helper: getFullName().",
      "priority": "urgent",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B1"]
    },
    {
      "id": "B3",
      "name": "User Service and Repository",
      "description": "UserRepository with findByTenantIdAndEmail, findByIdAndTenantId, findByTenantIdAndStatus, existsByTenantIdAndEmail, countByTenantIdAndStatus, findByManagerId. UserService with listUsers, createUser (validates email uniqueness, checks maxUsers governor limit), getUser, updateUser, deactivateUser (sets INACTIVE), recordLogin (creates login_history), getManagerChain (walks manager_id chain).",
      "priority": "urgent",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B2"]
    },
    {
      "id": "B4",
      "name": "User Controller",
      "description": "REST controller at /control/users (tenant-scoped). Endpoints: GET (list with filter), POST (create, requires ADMIN or MANAGE_USERS), GET /{id}, PUT /{id}, POST /{id}/deactivate, GET /{id}/login-history, GET /me (current user profile).",
      "priority": "high",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B3"]
    },
    {
      "id": "B5",
      "name": "JIT User Provisioning",
      "description": "JitUserProvisioningService that auto-creates local user record on first OIDC login. provisionOrUpdate(tenantId, jwtClaims): looks up user by tenant+email, creates if missing with claims (email, given_name, family_name, preferred_username), assigns default 'Standard User' profile.\n\nCalled from SecurityConfig JWT authentication converter and gateway via POST /internal/users/provision.",
      "priority": "high",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["A10", "B3"]
    },
    {
      "id": "B6",
      "name": "Login History Tracking",
      "description": "LoginHistory entity for login_history table (userId, tenantId, loginTime, sourceIp, loginType, status, userAgent). Integration with UserService.recordLogin() called from JitUserProvisioningService and gateway's JwtAuthenticationFilter.",
      "priority": "medium",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B3"]
    },
    {
      "id": "B7",
      "name": "User Management UI",
      "description": "Frontend page UserManagement.tsx. SDK additions: users.list, get, create, update, deactivate, getLoginHistory, me. UI features: user table (name, email, status, profile, last login), search by name/email, status filter, create user form, bulk deactivate.",
      "priority": "medium",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B4"]
    },
    {
      "id": "B8",
      "name": "User Detail UI",
      "description": "Frontend page UserDetail.tsx. Displays: user info, profile assignment dropdown, permission set assignments (multi-select), manager assignment (user lookup), login history table.",
      "priority": "low",
      "labels": ["Phase 1", "Users & Auth"],
      "blocked_by": ["B7"]
    },
    {
      "id": "C1",
      "name": "Permission Database Migration",
      "description": "Flyway migration V11__add_permission_tables.sql. Creates tables: profile, object_permission, field_permission, system_permission, permission_set, permset_object_permission, permset_field_permission, permset_system_permission, user_permission_set. Adds FK from platform_user.profile_id to profile.id.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["B1"]
    },
    {
      "id": "C2",
      "name": "Profile Entity",
      "description": "JPA entity for profile table: tenantId, name, description, isSystem. OneToMany relationships to ObjectPermission, FieldPermission, SystemPermission with cascade ALL and orphanRemoval.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C1"]
    },
    {
      "id": "C3",
      "name": "ObjectPermission Entity",
      "description": "JPA entity for object_permission table: ManyToOne profile, collectionId, canCreate, canRead, canEdit, canDelete, canViewAll, canModifyAll booleans. Same pattern for PermsetObjectPermission with permissionSetId FK.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C1"]
    },
    {
      "id": "C4",
      "name": "FieldPermission Entity",
      "description": "JPA entity for field_permission table: ManyToOne profile, fieldId, visibility (VISIBLE/READ_ONLY/HIDDEN). Same pattern for PermsetFieldPermission.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C1"]
    },
    {
      "id": "C5",
      "name": "SystemPermission Entity",
      "description": "JPA entity for system_permission table: ManyToOne profile, permissionKey, granted boolean. Permission keys: MANAGE_USERS, CUSTOMIZE_APPLICATION, MANAGE_SHARING, MANAGE_WORKFLOWS, MANAGE_REPORTS, API_ACCESS, MANAGE_INTEGRATIONS, MANAGE_DATA, VIEW_SETUP, MANAGE_SANDBOX, VIEW_ALL_DATA, MODIFY_ALL_DATA. Same pattern for PermsetSystemPermission.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C1"]
    },
    {
      "id": "C6",
      "name": "PermissionSet Entity",
      "description": "JPA entity for permission_set table: tenantId, name, description, isSystem. OneToMany to PermsetObjectPermission, PermsetFieldPermission, PermsetSystemPermission. Junction entity UserPermissionSet with @IdClass for user_permission_set table.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C1"]
    },
    {
      "id": "C7",
      "name": "PermissionResolver Service",
      "description": "Single source of truth for user permissions. resolveObjectPermission(userId, collectionId) - loads profile + permission sets, OR-merges CRUD flags. resolveFieldPermission(userId, fieldId) - most permissive wins (VISIBLE > READ_ONLY > HIDDEN). hasSystemPermission(userId, key). getEffectiveSystemPermissions(userId).\n\nCache in Redis (key: perm:{userId}:{collectionId}, TTL: 5 min). Evict on profile/permission set changes via Kafka event.",
      "priority": "urgent",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C2", "C3", "C4", "C5", "C6", "B3"]
    },
    {
      "id": "C8",
      "name": "Profile Service",
      "description": "CRUD for profiles. listProfiles, createProfile (validates name uniqueness per tenant), getProfile, updateProfile, setObjectPermissions (upserts for profile+collection), setFieldPermissions, setSystemPermissions, deleteProfile (cannot delete system profiles, validates no users assigned).",
      "priority": "high",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C7"]
    },
    {
      "id": "C9",
      "name": "PermissionSet Service",
      "description": "CRUD for permission sets plus user assignment management. Same CRUD pattern as ProfileService. Additional: assignToUser(userId, permissionSetId), removeFromUser(userId, permissionSetId), getUserPermissionSets(userId).",
      "priority": "high",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C7"]
    },
    {
      "id": "C10",
      "name": "Profile and PermissionSet Controllers",
      "description": "ProfileController at /control/profiles: GET, POST, GET /{id}, PUT /{id}, DELETE /{id}, PUT /{id}/object-permissions/{collectionId}, PUT /{id}/field-permissions, PUT /{id}/system-permissions.\n\nPermissionSetController at /control/permission-sets: GET, POST, GET /{id}, PUT /{id}, DELETE /{id}, POST /{id}/assign/{userId}, DELETE /{id}/assign/{userId}.",
      "priority": "high",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C8", "C9"]
    },
    {
      "id": "C11",
      "name": "Refactor Gateway Authorization for Permissions",
      "description": "Replace PolicyEvaluator with profile-based permission system. RouteAuthorizationFilter checks EffectiveObjectPermission (maps HTTP methods to CRUD flags). FieldAuthorizationFilter checks EffectiveFieldPermission (HIDDEN=remove, READ_ONLY=reject writes, VISIBLE=pass).\n\nCache: GET /internal/permissions/{userId}, Redis cache, invalidate via Kafka event emf.config.permissions.changed. Feature flag: emf.gateway.use-profiles=true.",
      "priority": "high",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C7"]
    },
    {
      "id": "C12",
      "name": "Default Profile Seeding",
      "description": "During tenant provisioning, create four default profiles: System Administrator (all CRUD + ViewAll + ModifyAll, all system perms), Standard User (Create + Read + Edit, API_ACCESS), Read Only (Read only), Minimum Access (no object perms). All marked is_system=true. First user gets System Administrator profile.",
      "priority": "high",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C8"]
    },
    {
      "id": "C13",
      "name": "Permission Administration UI",
      "description": "Frontend page ProfileManagement.tsx. Profile list with user count, create/edit dialog, detail page with three tabs: Object Permissions (matrix grid), Field Permissions (grouped by collection), System Permissions (checklist). SDK additions for profiles and permissionSets CRUD + assignment.",
      "priority": "medium",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C10"]
    },
    {
      "id": "C14",
      "name": "Field Permission Editor UI",
      "description": "Component within ProfileManagement.tsx. Collection selector dropdown, field visibility toggle table (Visible/Read Only/Hidden), bulk actions (Set all to Visible/Hidden), preview mode showing field visibility as the profile would see it.",
      "priority": "low",
      "labels": ["Phase 1", "Permissions"],
      "blocked_by": ["C13"]
    },
    {
      "id": "D1",
      "name": "Sharing Database Migration",
      "description": "Flyway migration V12__add_sharing_tables.sql. Creates: org_wide_default, sharing_rule, record_share, user_group, user_group_member tables. Adds parent_role_id and hierarchy_level to role table.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["C7"]
    },
    {
      "id": "D2",
      "name": "OrgWideDefault Entity",
      "description": "JPA entity for org_wide_default table: tenantId, collectionId, internalAccess (PRIVATE/PUBLIC_READ/PUBLIC_READ_WRITE, default PUBLIC_READ_WRITE), externalAccess (default PRIVATE). Default behavior: if no OWD record, default is PUBLIC_READ_WRITE.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D1"]
    },
    {
      "id": "D3",
      "name": "Role Hierarchy Enhancement",
      "description": "Add parent-child relationships to Role entity: parentRole (ManyToOne), hierarchyLevel, childRoles (OneToMany). Service additions: getRoleHierarchy(tenantId), getSubordinateRoleIds(roleId) - recursive. Users in parent roles can see subordinate users' records when OWD is PRIVATE.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D1"]
    },
    {
      "id": "D4",
      "name": "Group Entity",
      "description": "UserGroup JPA entity: tenantId, name, description, groupType (PUBLIC/QUEUE). ManyToMany with User via user_group_member junction table.",
      "priority": "medium",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D1"]
    },
    {
      "id": "D5",
      "name": "SharingRule Entity",
      "description": "JPA entity for sharing_rule table: tenantId, collectionId, name, ruleType (OWNER_BASED/CRITERIA_BASED), sharedFrom, sharedTo, sharedToType (ROLE/GROUP/QUEUE), accessLevel (READ/READ_WRITE), criteria (JSONB), active.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D1"]
    },
    {
      "id": "D6",
      "name": "RecordShare Entity",
      "description": "JPA entity for record_share table: tenantId, collectionId, recordId, sharedWithId, sharedWithType (USER/GROUP/ROLE), accessLevel (READ/READ_WRITE), reason (MANUAL/RULE/TEAM/TERRITORY), createdBy.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D1"]
    },
    {
      "id": "D7",
      "name": "RecordAccessService",
      "description": "Core record access algorithm. canAccess(userId, collectionId, recordId, recordOwnerId, accessType): 1) Object permission check, 2) canViewAll/canModifyAll bypass, 3) OWD check, 4) ownership check, 5) role hierarchy check, 6) sharing rules, 7) manual shares, 8) deny.\n\nbuildSharingWhereClause(userId, collectionId) for list query filtering.",
      "priority": "urgent",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D2", "D3", "D5", "D6"]
    },
    {
      "id": "D8",
      "name": "Update StorageAdapter for Sharing",
      "description": "Inject sharing WHERE clauses into PhysicalTableStorageAdapter.query(). Call RecordAccessService.buildSharingWhereClause() before query execution. Add owner_id VARCHAR(36) system column to all tables created by initializeCollection(). Set owner_id to current user on record creation.",
      "priority": "high",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D7"]
    },
    {
      "id": "D9",
      "name": "Sharing Administration UI",
      "description": "Frontend page SharingSettings.tsx. Per-collection OWD settings dropdown. Sharing rules CRUD per collection. Sharing rule editor (rule type, shared from/to, access level). Manual share viewer per record. SDK additions for sharing operations.",
      "priority": "medium",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D7"]
    },
    {
      "id": "D10",
      "name": "Role Hierarchy Visualization UI",
      "description": "Frontend page RoleHierarchy.tsx. Tree visualization of parent-child role relationships, drag-and-drop rearrangement, click to see assigned users, create/edit role dialog with parent selector.",
      "priority": "low",
      "labels": ["Phase 1", "Sharing"],
      "blocked_by": ["D3"]
    },
    {
      "id": "E1",
      "name": "Tenant-Scoped OIDC Configuration",
      "description": "OidcProviderService already tenant-scoped via A10. Main change: gateway can look up OIDC provider by JWT issuer, then derive tenant. New internal endpoint: GET /internal/oidc/by-issuer?issuer={issuer} (cached in Redis).",
      "priority": "high",
      "labels": ["Phase 1", "OIDC"],
      "blocked_by": ["A10"]
    },
    {
      "id": "E2",
      "name": "Multi-Provider JWT Validation",
      "description": "Replace single issuerUri in gateway SecurityConfig with DynamicReactiveJwtDecoder. Process: parse JWT header (kid) + body (iss) without validation, look up OidcProvider by issuer (cached), fetch JWKS, validate signature + claims, set tenantId from provider's tenant_id.\n\nReplaces current static ReactiveJwtDecoder bean.",
      "priority": "high",
      "labels": ["Phase 1", "OIDC"],
      "blocked_by": ["E1"]
    },
    {
      "id": "E3",
      "name": "OIDC Admin UI Updates",
      "description": "Update existing OIDC provider management UI to scope to current tenant (backend already scoped via A10). Add 'Test Connection' button that validates issuer URL and JWKS endpoint reachability.",
      "priority": "low",
      "labels": ["Phase 1", "OIDC"],
      "blocked_by": ["E2"]
    },
    {
      "id": "F1",
      "name": "Setup Audit Trail Migration and Entity",
      "description": "Flyway migration V13__add_setup_audit_trail.sql. Creates setup_audit_trail table: tenantId FK, userId FK to platform_user, action, section, entityType, entityId, entityName, oldValue JSONB, newValue JSONB, timestamp. Indexes on tenant+time and entity_type+entity_id.",
      "priority": "medium",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["B3"]
    },
    {
      "id": "F2",
      "name": "SetupAuditService",
      "description": "Service with log(action, section, entityType, entityId, entityName, oldValue, newValue) - gets tenant and user from context, serializes to JSON. getAuditTrail(filter, pageable) with filters by section, entity_type, user, date range.\n\nAOP: @SetupAudited annotation + aspect for automatic before/after capture on service methods.",
      "priority": "medium",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["F1"]
    },
    {
      "id": "F3",
      "name": "Governor Limits Enforcement",
      "description": "GovernorLimitsService with checkApiCallLimit (Redis counter per tenant per day), checkUserLimit (count active users), checkCollectionLimit, checkFieldLimit. getStatus returns usage vs limits.\n\nIntegration: called from TenantResolutionFilter for API counting, CollectionService for collection limit, UserService for user limit.",
      "priority": "medium",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["A10", "B3"]
    },
    {
      "id": "F4",
      "name": "Test Suite Updates",
      "description": "Update all existing tests for tenant context. Add TestTenantContextHelper. Update @BeforeEach to create test tenant. Verify tenant isolation (data in tenant A invisible from tenant B).\n\nNew test classes: TenantIsolationIntegrationTest, PermissionResolverTest, RecordAccessServiceTest, TenantResolutionFilterTest.",
      "priority": "medium",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["A10", "C7", "D7"]
    },
    {
      "id": "F5",
      "name": "Setup Audit Trail UI",
      "description": "Frontend page SetupAuditTrail.tsx. Chronological log of configuration changes, filters (date range, section, entity type, user), expandable rows with old/new values JSON diff view, export to CSV.",
      "priority": "low",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["F2"]
    },
    {
      "id": "F6",
      "name": "Governor Limits Dashboard UI",
      "description": "Component within TenantDashboard.tsx. Progress bars for each limit category (API calls, storage, users, collections), usage trends line chart, alert indicators when approaching limits (>80%).",
      "priority": "low",
      "labels": ["Phase 1", "Cross-cutting"],
      "blocked_by": ["F3"]
    },
    {
      "id": "P2",
      "name": "[Phase 2] Enhanced Object Model and Validation",
      "description": "Builds on Phase 1's tenant isolation. Makes the collection/field system powerful enough to model real business data.\n\nWork items:\n- 2.1 Extended Field Types (picklist, auto-number, currency, formula, rollup, etc.)\n- 2.2 Picklist Management (global picklists, dependent picklists)\n- 2.3 Relationship Types (Lookup and Master-Detail)\n- 2.4 Validation Rules Engine\n- 2.5 Record Types\n- 2.6 Field History Tracking\n- 2.7 Setup Audit Trail enhancements",
      "priority": "medium",
      "labels": ["Phase 2"],
      "blocked_by": []
    },
    {
      "id": "P3",
      "name": "[Phase 3] UI Framework and Reporting",
      "description": "Builds on Phase 2's enhanced object model. Gives users the ability to customize their interface and analyze their data.\n\nWork items:\n- 3.1 Structured Page Layout Model\n- 3.2 List Views\n- 3.3 Report Builder\n- 3.4 Dashboard Builder\n- 3.5 Data Export",
      "priority": "medium",
      "labels": ["Phase 3"],
      "blocked_by": []
    },
    {
      "id": "P4",
      "name": "[Phase 4] Workflow and Automation",
      "description": "Builds on Phase 2's validation engine and formula evaluator. Adds declarative business process automation.\n\nWork items:\n- 4.1 Workflow Rules\n- 4.2 Approval Processes\n- 4.3 Flow Engine\n- 4.4 Scheduled Jobs\n- 4.5 Formula Fields and Roll-Up Summaries\n- 4.6 Email Templates and Alerts",
      "priority": "medium",
      "labels": ["Phase 4"],
      "blocked_by": []
    },
    {
      "id": "P5",
      "name": "[Phase 5] Integration and Scripting",
      "description": "Opens the platform to external systems and custom logic.\n\nWork items:\n- 5.1 Server-Side Scripting Engine\n- 5.2 Webhooks\n- 5.3 Connected Apps\n- 5.4 Bulk and Composite APIs",
      "priority": "medium",
      "labels": ["Phase 5"],
      "blocked_by": []
    },
    {
      "id": "P6",
      "name": "[Phase 6] Enterprise Features",
      "description": "The final phase adds capabilities that large organizations require.\n\nWork items:\n- 6.1 Full-Text Search\n- 6.2 EMF-QL Query Language\n- 6.3 Notification System\n- 6.4 File and Document Management\n- 6.5 Data Import/Export\n- 6.6 Sandbox and Environment Management\n- 6.7 Localization / i18n\n- 6.8 Mobile-Responsive API",
      "priority": "medium",
      "labels": ["Phase 6"],
      "blocked_by": []
    }
  ]
}
